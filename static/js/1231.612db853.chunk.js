"use strict";(self.webpackChunkmaptest=self.webpackChunkmaptest||[]).push([[1231],{91231:function(t,e,i){i.r(e),i.d(e,{default:function(){return q}});var r=i(1413),a=i(74165),n=i(15861),s=i(15671),o=i(43144),h=i(60136),u=i(29388),p=i(27366),l=i(32718),c=i(66978),g=i(94172),d=i(49861),y=(i(25243),i(63780),i(69912)),m=i(78983),f=i(90110),v=i(95986),_=i(34035),w=i(83978),k=i(9229),x=i(67581),C=i(11752),H=i(61120),Z=i(45948),b=i(44041),I=i(13107),V=i(84848),P=i(45008),U=function(t){(0,h.Z)(i,t);var e=(0,u.Z)(i);function i(){var t;return(0,s.Z)(this,i),(t=e.apply(this,arguments))._highlightGraphics=new m.J,t._updateHash="",t}return(0,o.Z)(i,[{key:"fetchPopupFeatures",value:function(t,e){return this._popupHighlightHelper.fetchPopupFeatures(t,e)}},{key:"update",value:function(t){var e=this,i="".concat(this.exportImageVersion,"/").concat(t.state.id,"/").concat(t.pixelRatio,"/").concat(t.stationary);this._updateHash!==i&&(this._updateHash=i,this.strategy.update(t).catch((function(t){(0,c.D_)(t)||l.Z.getLogger(e.declaredClass).error(t)})),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}},{key:"attach",value:function(){var t=this,e=this.layer,i=e.imageMaxWidth,r=e.imageMaxHeight,a=e.version,n=a>=10.3,s=a>=10;this._bitmapContainer=new f.c,this.container.addChild(this._bitmapContainer),this._highlightView=new _.Z({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:function(){return t.requestUpdate()},container:new w.Z(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new V.VF({createFetchPopupFeaturesQueryGeometry:function(e,i){return(0,P.K)(e,i,t.view)},highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:function(e,i){t._highlightView.graphicUpdateHandler({graphic:e,property:i})},layerView:this,updatingHandles:this.updatingHandles}),this.strategy=new k.Z({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:i,imageMaxHeight:r,imageRotationSupported:n,imageNormalizationSupported:s,hidpi:!0}),this.addAttachHandles((0,g.YP)((function(){return t.exportImageVersion}),(function(){return t.requestUpdate()}))),this.requestUpdate()}},{key:"detach",value:function(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"supportsSpatialReference",value:function(t){return this.layer.serviceSupportsSpatialReference(t)}},{key:"doRefresh",value:function(){var t=(0,n.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._updateHash="",this.requestUpdate();case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"fetchImage",value:function(t,e,i,a){return this.layer.fetchImage(t,e,i,(0,r.Z)({timeExtent:this.timeExtent,floors:this.floors},a))}},{key:"fetchImageBitmap",value:function(t,e,i,a){return this.layer.fetchImageBitmap(t,e,i,(0,r.Z)({timeExtent:this.timeExtent,floors:this.floors},a))}},{key:"highlight",value:function(t){return this._popupHighlightHelper.highlight(t)}}]),i}(function(t){var e=function(t){(0,h.Z)(i,t);var e=(0,u.Z)(i);function i(){return(0,s.Z)(this,i),e.apply(this,arguments)}return(0,o.Z)(i,[{key:"initialize",value:function(){this.exportImageParameters=new b.R({layer:this.layer})}},{key:"destroy",value:function(){this.exportImageParameters.destroy(),this.exportImageParameters=null}},{key:"floors",get:function(){var t,e;return null!==(t=null===(e=this.view)||void 0===e?void 0:e.floors)&&void 0!==t?t:null}},{key:"exportImageVersion",get:function(){var t;return null!==(t=this.exportImageParameters)&&void 0!==t&&t.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}},{key:"canResume",value:function(){var t;return!!(0,C.Z)((0,H.Z)(i.prototype),"canResume",this).call(this)&&!(null!==(t=this.timeExtent)&&void 0!==t&&t.isEmpty)}}]),i}(t);return(0,p._)([(0,d.Cb)()],e.prototype,"exportImageParameters",void 0),(0,p._)([(0,d.Cb)({readOnly:!0})],e.prototype,"floors",null),(0,p._)([(0,d.Cb)({readOnly:!0})],e.prototype,"exportImageVersion",null),(0,p._)([(0,d.Cb)()],e.prototype,"layer",void 0),(0,p._)([(0,d.Cb)()],e.prototype,"suspended",void 0),(0,p._)([(0,d.Cb)(Z.qG)],e.prototype,"timeExtent",void 0),e=(0,p._)([(0,y.j)("esri.views.layers.MapImageLayerView")],e)}((0,I.Z)((0,v.y)(x.Z))));(0,p._)([(0,d.Cb)()],U.prototype,"strategy",void 0),(0,p._)([(0,d.Cb)()],U.prototype,"updating",void 0);var q=U=(0,p._)([(0,y.j)("esri.views.2d.layers.MapImageLayerView2D")],U)}}]);
//# sourceMappingURL=1231.612db853.chunk.js.map