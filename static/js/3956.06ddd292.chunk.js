"use strict";(self.webpackChunkmaptest=self.webpackChunkmaptest||[]).push([[3956,2564],{22564:function(e,t,n){n.d(t,{Hy:function(){return b},OF:function(){return T},TD:function(){return g},Tu:function(){return x},VO:function(){return Z},aV:function(){return m},kq:function(){return y},rH:function(){return o}});var r,i,o,a=n(97326),s=n(43144),u=n(15671),c=n(60136),l=n(29388),d=n(98737),h=n(4942);!function(e){e.AsyncNotEnabled="AsyncNotEnabled",e.ModulesNotSupported="ModulesNotSupported",e.CircularModules="CircularModules",e.NeverReach="NeverReach",e.UnsupportedHashType="UnsupportedHashType",e.InvalidParameter="InvalidParameter",e.UnexpectedToken="UnexpectedToken",e.Unrecognised="Unrecognised",e.UnrecognisedType="UnrecognisedType",e.MaximumCallDepth="MaximumCallDepth",e.BooleanConditionRequired="BooleanConditionRequired",e.TypeNotAllowedInFeature="TypeNotAllowedInFeature",e.KeyMustBeString="KeyMustBeString",e.WrongNumberOfParameters="WrongNumberOfParameters",e.CallNonFunction="CallNonFunction",e.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral",e.NoFunctionInDictionary="NoFunctionInDictionary",e.NoFunctionInArray="NoFunctionInArray",e.AssignModuleFunction="AssignModuleFunction",e.LogicExpressionOrAnd="LogicExpressionOrAnd",e.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean",e.FuncionNotFound="FunctionNotFound",e.InvalidMemberAccessKey="InvalidMemberAccessKey",e.UnsupportedUnaryOperator="UnsupportUnaryOperator",e.InvalidIdentifier="InvalidIdentifier",e.MemberOfNull="MemberOfNull",e.UnsupportedOperator="UnsupportedOperator",e.Cancelled="Cancelled",e.ModuleAccessorMustBeString="ModuleAccessorMustBeString",e.ModuleExportNotFound="ModuleExportNotFound",e.Immutable="Immutable",e.OutOfBounds="OutOfBounds",e.IllegalResult="IllegalResult",e.FieldNotFound="FieldNotFound",e.PortalRequired="PortalRequired",e.LogicError="LogicError",e.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber",e.KeyAccessorMustBeString="KeyAccessorMustBeString",e.WrongSpatialReference="WrongSpatialReference"}(o||(o={}));var f=(r={},(0,h.Z)(r,o.TypeNotAllowedInFeature,"Feature attributes only support dates, numbers, strings, guids."),(0,h.Z)(r,o.LogicError,"Logic error - {reason}"),(0,h.Z)(r,o.NeverReach,"Encountered unreachable logic"),(0,h.Z)(r,o.AsyncNotEnabled,"Async Arcade must be enabled for this script"),(0,h.Z)(r,o.ModuleAccessorMustBeString,"Module accessor must be a string"),(0,h.Z)(r,o.ModuleExportNotFound,"Module has no export with provided identifier"),(0,h.Z)(r,o.ModulesNotSupported,"Current profile does not support modules"),(0,h.Z)(r,o.ArrayAccessorMustBeNumber,"Array accessor must be a number"),(0,h.Z)(r,o.FuncionNotFound,"Function not found"),(0,h.Z)(r,o.FieldNotFound,"Key not found - {key}"),(0,h.Z)(r,o.CircularModules,"Circular module dependencies are not allowed"),(0,h.Z)(r,o.Cancelled,"Execution cancelled"),(0,h.Z)(r,o.UnsupportedHashType,"Type not supported in hash function"),(0,h.Z)(r,o.IllegalResult,"Value is not a supported return type"),(0,h.Z)(r,o.PortalRequired,"Portal is required"),(0,h.Z)(r,o.InvalidParameter,"Invalid parameter"),(0,h.Z)(r,o.WrongNumberOfParameters,"Call with wrong number of parameters"),(0,h.Z)(r,o.Unrecognised,"Unrecognised code structure"),(0,h.Z)(r,o.UnrecognisedType,"Unrecognised type"),(0,h.Z)(r,o.WrongSpatialReference,"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference"),(0,h.Z)(r,o.BooleanConditionRequired,"Conditions must use booleans"),(0,h.Z)(r,o.NoFunctionInDictionary,"Dictionaries cannot contain functions."),(0,h.Z)(r,o.NoFunctionInArray,"Arrays cannot contain functions."),(0,h.Z)(r,o.NoFunctionInTemplateLiteral,"Template Literals do not expect functions by value."),(0,h.Z)(r,o.KeyAccessorMustBeString,"Accessor must be a string"),(0,h.Z)(r,o.KeyMustBeString,"Object keys must be a string"),(0,h.Z)(r,o.Immutable,"Object is immutable"),(0,h.Z)(r,o.InvalidParameter,"Invalid parameter"),(0,h.Z)(r,o.UnexpectedToken,"Unexpected token"),(0,h.Z)(r,o.MemberOfNull,"Cannot access property of null object"),(0,h.Z)(r,o.MaximumCallDepth,"Exceeded maximum function depth"),(0,h.Z)(r,o.OutOfBounds,"Out of bounds"),(0,h.Z)(r,o.InvalidIdentifier,"Identifier not recognised"),(0,h.Z)(r,o.FuncionNotFound,"Function not found"),(0,h.Z)(r,o.CallNonFunction,"Expression is not a function"),(0,h.Z)(r,o.InvalidMemberAccessKey,"Cannot access value using a key of this type"),(0,h.Z)(r,o.AssignModuleFunction,"Cannot assign function to module variable"),(0,h.Z)(r,o.UnsupportedUnaryOperator,"Unsupported unary operator"),(0,h.Z)(r,o.UnsupportedOperator,"Unsupported operator"),(0,h.Z)(r,o.LogicalExpressionOnlyBoolean,"Logical expressions must be boolean"),(0,h.Z)(r,o.LogicExpressionOrAnd,"Logical expression can only be combined with || or &&"),r),p=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){(0,u.Z)(this,n);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.call.apply(t,[this].concat(r))}return(0,s.Z)(n)}((0,d.Z)(Error)),v=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,_(r)+e.message,{cause:e})).loc=null,Error.captureStackTrace&&Error.captureStackTrace((0,a.Z)(i),n),r&&r.loc&&(i.loc=r.loc),i}return(0,s.Z)(n)}(p),m=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r,i,o){var s;return(0,u.Z)(this,n),(s=t.call(this,"Execution error - "+_(i)+b(f[r],o))).loc=null,s.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace((0,a.Z)(s),n),i&&i.loc&&(s.loc=i.loc),s}return(0,s.Z)(n)}((0,d.Z)(Error));function _(e){var t,n;return e&&e.loc?"Line : ".concat(null===(t=e.loc.start)||void 0===t?void 0:t.line,", ").concat(null===(n=e.loc.start)||void 0===n?void 0:n.column,": "):""}var g,T=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r,i,o){var s;return(0,u.Z)(this,n),(s=t.call(this,"Compilation error - "+_(i)+b(f[r],o))).loc=null,s.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace((0,a.Z)(s),n),i&&i.loc&&(s.loc=i.loc),s}return(0,s.Z)(n)}((0,d.Z)(Error)),y=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this,"Uncompilable code structures")).declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace((0,a.Z)(e),n),e}return(0,s.Z)(n)}((0,d.Z)(Error));function b(e,t){try{if(!t)return e;for(var n in t){var r=t[n];r||(r=""),e=e.replace("{"+n+"}",t[n])}}catch(p){}return e}function Z(e,t,n){return"esri.arcade.arcadeexecutionerror"===n.declaredRootClass||"esri.arcade.arcadecompilationerror"===n.declaredRootClass?null===n.loc&&t&&t.loc?new v(n,{cause:n}):n:("esri.arcade.featureset.support.featureseterror"===n.declaredRootClass||"esri.arcade.featureset.support.sqlerror"===n.declaredRootClass||n.declaredRootClass,t&&t.loc?new v(n,{cause:n}):n)}!function(e){e.UnrecognisedUri="UnrecognisedUri",e.UnsupportedUriProtocol="UnsupportedUriProtocol"}(g||(g={}));var O=(i={},(0,h.Z)(i,g.UnrecognisedUri,"Unrecognised uri - {uri}"),(0,h.Z)(i,g.UnsupportedUriProtocol,"Unrecognised uri protocol"),i),x=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,b(O[e],r))).declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace((0,a.Z)(i),n),i}return(0,s.Z)(n)}((0,d.Z)(Error))},40237:function(e,t,n){n.d(t,{N:function(){return o}});var r=n(43144),i=n(15671),o={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){var r=new a(e.getPointX(t),e.getPointY(t),n),i=e.hasZ(t),o=e.hasM(t);return i&&(r.z=e.getPointZ(t)),o&&(r.m=e.getPointM(t)),r},exportPolygon:function(e,t,n){return new s(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new u(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new c(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){var r=e.hasZ(t),i=e.hasM(t),o=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(r){var a=e.getZExtent(t);o.zmin=a.vmin,o.zmax=a.vmax}if(i){var s=e.getMExtent(t);o.mmin=s.vmin,o.mmax=s.vmax}return o}};var a=(0,r.Z)((function e(t,n,r){(0,i.Z)(this,e),this.x=t,this.y=n,this.spatialReference=r,this.z=void 0,this.m=void 0}));var s=(0,r.Z)((function e(t,n,r,o){(0,i.Z)(this,e),this.rings=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),o&&(this.hasM=o)}));var u=(0,r.Z)((function e(t,n,r,o){(0,i.Z)(this,e),this.paths=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),o&&(this.hasM=o)}));var c=(0,r.Z)((function e(t,n,r,o){(0,i.Z)(this,e),this.points=t,this.spatialReference=n,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),o&&(this.hasM=o)}));var l=(0,r.Z)((function e(t,n,r,o,a){(0,i.Z)(this,e),this.xmin=t,this.ymin=n,this.xmax=r,this.ymax=o,this.spatialReference=a,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}))},85981:function(e,t,n){n.d(t,{Ue:function(){return u},nF:function(){return l},zk:function(){return c}});var r=n(16889),i=n(21530),o=n(11186),a=n(71353),s=n(51378);function u(e){return e?{origin:(0,a.a)(e.origin),vector:(0,a.a)(e.vector)}:{origin:(0,a.c)(),vector:(0,a.c)()}}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u();return(0,o.c)(n.origin,e),(0,o.b)(n.vector,t,e),n}function l(e,t,n){return function(e,t,n,i,a){var u=e.vector,c=e.origin,l=(0,o.b)(s.WM.get(),t,c),d=(0,o.e)(u,l)/(0,o.p)(u);return(0,o.g)(a,u,(0,r.uZ)(d,n,i)),(0,o.a)(a,a,e.origin)}(e,t,0,1,n)}(0,a.c)(),(0,a.c)(),new i.x((function(){return u()}))},19995:function(e,t,n){n.d(t,{_W:function(){return g},iV:function(){return Z},oj:function(){return E}});var r=n(74165),i=n(15671),o=n(43144),a=n(15861),s=n(37762),u=n(29439),c=n(92026),l=n(79803),d=n(40237),h=n(92975),f=n(81753),p=[0,0];function v(e,t){if(!t)return null;if("x"in t){var n,r,i={x:0,y:0};return n=e(t.x,t.y,p),r=(0,u.Z)(n,2),i.x=r[0],i.y=r[1],null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){var o,a,s,c,l={xmin:0,ymin:0,xmax:0,ymax:0};return o=e(t.xmin,t.ymin,p),a=(0,u.Z)(o,2),l.xmin=a[0],l.ymin=a[1],s=e(t.xmax,t.ymax,p),c=(0,u.Z)(s,2),l.xmax=c[0],l.ymax=c[1],t.hasZ&&(l.zmin=t.zmin,l.zmax=t.zmax,l.hasZ=!0),t.hasM&&(l.mmin=t.mmin,l.mmax=t.mmax,l.hasM=!0),l}return"rings"in t?{rings:m(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:m(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:_(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function m(e,t){var n,r=[],i=(0,s.Z)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.push(_(o,t))}}catch(a){i.e(a)}finally{i.f()}return r}function _(e,t){var n,r=[],i=(0,s.Z)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=t(o[0],o[1],[0,0]);r.push(a),o.length>2&&a.push(o[2]),o.length>3&&a.push(o[3])}}catch(u){i.e(u)}finally{i.f()}return r}function g(e,t){return T.apply(this,arguments)}function T(){return(T=(0,a.Z)((0,r.Z)().mark((function e(t,n){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return");case 2:return i=Array.isArray(t)?t.map((function(e){return(0,c.pC)(e.geometry)?e.geometry.spatialReference:null})).filter(c.pC):[t],e.next=5,(0,l.iQ)(i.map((function(e){return{source:e,dest:n}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=v.bind(null,f.hG),b=v.bind(null,f.R6);function Z(e,t,n,r){if(!e)return e;if(n||(n=t,t=e.spatialReference),!(0,h.JY)(t)||!(0,h.JY)(n)||(0,h.fS)(t,n))return e;if((0,f.Q8)(t,n)){var i=(0,h.sS)(n)?y(e):b(e);return i.spatialReference=n,i}return(0,l.oj)(d.N,[e],t,n,null,r)[0]}var O=function(){function e(){(0,i.Z)(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return(0,o.Z)(e,[{key:"push",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,i){var o,a=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&n&&i&&!(0,h.fS)(n,i)){e.next=2;break}return e.abrupt("return",t);case 2:return o={geometries:t,inSpatialReference:n,outSpatialReference:i,resolve:null},e.abrupt("return",(this._jobs.push(o),new Promise((function(e){o.resolve=e,null===a._timer&&(a._timer=setTimeout(a._process,10))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,n=e.inSpatialReference,r=e.outSpatialReference,i=e.resolve;(0,f.Q8)(n,r)?(0,h.sS)(r)?i(t.map(y)):i(t.map(b)):i((0,l.oj)(d.N,t,n,r,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}(),x=new O;function E(e,t,n){return x.push(e,t,n)}},97731:function(e,t,n){n.d(t,{hu:function(){return a},yK:function(){return s}});var r=n(15671),i=n(43144),o=(n(6394),n(90045),(0,n(67077).c)(),function(){function e(t){(0,r.Z)(this,e),this.message=t}return(0,i.Z)(e,[{key:"toString",value:function(){return"AssertException: ".concat(this.message)}}]),e}());function a(e,t){if(!e){t=t||"Assertion";var n=new Error(t).stack;throw new o("".concat(t," at ").concat(n))}}function s(e,t,n,r){var i,o=(n[0]-e[0])/t[0],a=(r[0]-e[0])/t[0];o>a&&(i=o,o=a,a=i);var s=(n[1]-e[1])/t[1],u=(r[1]-e[1])/t[1];if(s>u&&(i=s,s=u,u=i),o>u||s>a)return!1;s>o&&(o=s),u<a&&(a=u);var c=(n[2]-e[2])/t[2],l=(r[2]-e[2])/t[2];return c>l&&(i=c,c=l,l=i),!(o>l||c>a)&&(l<a&&(a=l),!(a<0))}},10387:function(e,t,n){n.r(t),n.d(t,{default:function(){return ie}});var r=n(37762),i=n(74165),o=n(15861),a=n(15671),s=n(43144),u=n(27366),c=n(92026),l=n(66978),d=(n(32718),n(25243),n(63780),n(10064),n(93169),n(69912)),h=n(11186),f=n(71353),p=n(85981),v=n(23470),m=n(99987),_=n(13005),g=n(27546),T=n(21530),y=(n(14226),n(90045),n(67077)),b=n(40885);function Z(e){return e?{ray:(0,b.Ue)(e.ray),c0:e.c0,c1:e.c1}:{ray:(0,b.Ue)(),c0:0,c1:Number.MAX_VALUE}}var O,x;new T.x((function(){return Z()})),n(76146),n(51378);function E(e,t){for(var n=0;n<R.NUM;n++){var r=e[n];if(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]>=t[3])return!1}return!0}!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.BOTTOM=2]="BOTTOM",e[e.TOP=3]="TOP",e[e.NEAR=4]="NEAR",e[e.FAR=5]="FAR"}(O||(O={})),function(e){e[e.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",e[e.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",e[e.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",e[e.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",e[e.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",e[e.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",e[e.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",e[e.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(x||(x={}));var R,M;x.FAR_BOTTOM_RIGHT,x.NEAR_BOTTOM_RIGHT,x.NEAR_BOTTOM_LEFT,x.FAR_BOTTOM_LEFT,x.NEAR_BOTTOM_LEFT,x.NEAR_BOTTOM_RIGHT,x.NEAR_TOP_RIGHT,x.NEAR_TOP_LEFT,x.FAR_BOTTOM_RIGHT,x.FAR_BOTTOM_LEFT,x.FAR_TOP_LEFT,x.FAR_TOP_RIGHT,x.NEAR_BOTTOM_RIGHT,x.FAR_BOTTOM_RIGHT,x.FAR_TOP_RIGHT,x.NEAR_TOP_RIGHT,x.FAR_BOTTOM_LEFT,x.NEAR_BOTTOM_LEFT,x.NEAR_TOP_LEFT,x.FAR_TOP_LEFT,x.FAR_TOP_LEFT,x.NEAR_TOP_LEFT,x.NEAR_TOP_RIGHT,x.FAR_TOP_RIGHT;!function(e){e[e.NUM=6]="NUM"}(R||(R={})),function(e){e[e.NUM=8]="NUM"}(M||(M={}));(0,y.f)(-1,-1,-1,1),(0,y.f)(1,-1,-1,1),(0,y.f)(1,1,-1,1),(0,y.f)(-1,1,-1,1),(0,y.f)(-1,-1,1,1),(0,y.f)(1,-1,1,1),(0,y.f)(1,1,1,1),(0,y.f)(-1,1,1,1),new T.x(Z),(0,f.c)(),(0,f.c)(),(0,f.c)(),(0,f.c)(),(0,f.c)(),(0,f.c)(),(0,f.c)(),(0,f.c)();var N=n(97731),A=function(){function e(t,n){(0,a.Z)(this,e),this._objectToBoundingSphere=t,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new k,this._objectCount=0,n&&(void 0!==n.maximumObjectsPerNode&&(this._maximumObjectsPerNode=n.maximumObjectsPerNode),void 0!==n.maximumDepth&&(this._maximumDepth=n.maximumDepth))}return(0,s.Z)(e,[{key:"bounds",get:function(){return this._root.bounds}},{key:"halfSize",get:function(){return this._root.halfSize}},{key:"root",get:function(){return this._root.node}},{key:"maximumObjectsPerNode",get:function(){return this._maximumObjectsPerNode}},{key:"maximumDepth",get:function(){return this._maximumDepth}},{key:"objectCount",get:function(){return this._objectCount}},{key:"destroy",value:function(){this._degenerateObjects.clear(),k.clearPool(),z[0]=null,K.prune(),Q.prune()}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;this._objectCount+=t,this._grow(e,t);for(var n=k.acquire(),r=0;r<t;r++){var i=e[r];this._isDegenerate(i)?this._degenerateObjects.add(i):(n.init(this._root),this._add(i,n))}k.release(n)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._objectCount-=e.length;var n,i=k.acquire(),o=(0,r.Z)(e);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=(0,c.pC)(t)?t:(0,v.h)(this._objectToBoundingSphere(a),V);w(s[3])?(i.init(this._root),this._remove(a,s,i)):this._degenerateObjects.delete(a)}}catch(u){o.e(u)}finally{o.f()}k.release(i),this._shrink()}},{key:"update",value:function(e,t){if(w(t[3])||!this._isDegenerate(e)){var n=function(e){return z[0]=e,z}(e);this.remove(n,t),this.add(n)}}},{key:"forEachAlongRay",value:function(e,t,n){var r=this,i=(0,b.re)(e,t);this._forEachNode(this._root,(function(e){if(!r._intersectsNode(i,e))return!1;var t=e.node;return t.terminals.forAll((function(e){r._intersectsObject(i,e)&&n(e)})),null!==t.residents&&t.residents.forAll((function(e){r._intersectsObject(i,e)&&n(e)})),!0}))}},{key:"forEachAlongRayWithVerticalOffset",value:function(e,t,n,r){var i=this,o=(0,b.re)(e,t);this._forEachNode(this._root,(function(e){if(!i._intersectsNodeWithOffset(o,e,r))return!1;var t=e.node;return t.terminals.forAll((function(e){i._intersectsObjectWithOffset(o,e,r)&&n(e)})),null!==t.residents&&t.residents.forAll((function(e){i._intersectsObjectWithOffset(o,e,r)&&n(e)})),!0}))}},{key:"forEach",value:function(e){this._forEachNode(this._root,(function(t){var n=t.node;return n.terminals.forAll(e),null!==n.residents&&n.residents.forAll(e),!0})),this._degenerateObjects.forEach(e)}},{key:"forEachDegenerateObject",value:function(e){this._degenerateObjects.forEach(e)}},{key:"findClosest",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=1/0,s=1/0,u=null,c=B(e,t),l=function(c){if(--o,i(c)){var l=r._objectToBoundingSphere(c);if(E(n,l)){var d=P(e,t,(0,v.g)(l)),h=d-l[3],f=d+l[3];h<a&&(a=h,s=f,u=c)}}};return this._forEachNodeDepthOrdered(this._root,(function(r){if(o<=0||!E(n,r.bounds))return!1;if((0,h.g)(H,c,r.halfSize),(0,h.a)(H,H,r.bounds),P(e,t,H)>s)return!1;var i=r.node;return i.terminals.forAll((function(e){return l(e)})),null!==i.residents&&i.residents.forAll((function(e){return l(e)})),!0}),e,t),u}},{key:"forEachInDepthRange",value:function(t,n,r,i,o,a,s){var u=this,c=-1/0,l=1/0,d={setRange:function(t){r===e.DepthOrder.FRONT_TO_BACK?(c=Math.max(c,t.near),l=Math.min(l,t.far)):(c=Math.max(c,-t.far),l=Math.min(l,-t.near))}};d.setRange(i);var f=P(n,r,t),p=B(n,r),m=B(n,-r),_=function(e){if(s(e)){var t=u._objectToBoundingSphere(e),i=(0,v.g)(t),h=P(n,r,i)-f,p=h-t[3],m=h+t[3];p>l||m<c||!E(a,t)||o(e,d)}};this._forEachNodeDepthOrdered(this._root,(function(e){if(!E(a,e.bounds))return!1;if((0,h.g)(H,p,e.halfSize),(0,h.a)(H,H,e.bounds),P(n,r,H)-f>l)return!1;if((0,h.g)(H,m,e.halfSize),(0,h.a)(H,H,e.bounds),P(n,r,H)-f<c)return!1;var t=e.node;return t.terminals.forAll((function(e){return _(e)})),null!==t.residents&&t.residents.forAll((function(e){return _(e)})),!0}),n,r)}},{key:"forEachNode",value:function(e){this._forEachNode(this._root,(function(t){return e(t.node,t.bounds,t.halfSize)}))}},{key:"forEachNeighbor",value:function(e,t){var n=this,r=(0,v.a)(t),i=(0,v.g)(t),o=function(t){var o=n._objectToBoundingSphere(t),a=(0,v.a)(o),s=r+a;return!((0,h.d)((0,v.g)(o),i)-s*s<=0)||e(t)},a=!0,s=function(e){a&&(a=o(e))};this._forEachNode(this._root,(function(e){var t=(0,v.a)(e.bounds),n=r+t;if((0,h.d)((0,v.g)(e.bounds),i)-n*n>0)return!1;var o=e.node;return o.terminals.forAll(s),a&&null!==o.residents&&o.residents.forAll(s),a})),a&&this.forEachDegenerateObject(s)}},{key:"_intersectsNode",value:function(e,t){return I(t.bounds,2*-t.halfSize,G),I(t.bounds,2*t.halfSize,q),(0,N.yK)(e.origin,e.direction,G,q)}},{key:"_intersectsNodeWithOffset",value:function(e,t,n){return I(t.bounds,2*-t.halfSize,G),I(t.bounds,2*t.halfSize,q),n.applyToMinMax(G,q),(0,N.yK)(e.origin,e.direction,G,q)}},{key:"_intersectsObject",value:function(e,t){var n=this._objectToBoundingSphere(t);return!(n[3]>0)||(0,v.j)(n,e)}},{key:"_intersectsObjectWithOffset",value:function(e,t,n){var r=this._objectToBoundingSphere(t);return!(r[3]>0)||(0,v.j)(n.applyToBoundingSphere(r),e)}},{key:"_forEachNode",value:function(e,t){for(var n=k.acquire().init(e),r=[n];0!==r.length;){if(t(n=r.pop())&&!n.isLeaf())for(var i=0;i<n.node.children.length;i++)n.node.children[i]&&r.push(k.acquire().init(n).advance(i));k.release(n)}}},{key:"_forEachNodeDepthOrdered",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DepthOrder.FRONT_TO_BACK,o=k.acquire().init(t),a=[o];for(function(e,t,n){if(!Q.length)for(var r=0;r<8;++r)Q.push({index:0,distance:0});for(var i=0;i<8;++i){var o=L[i];Q.data[i].index=i,Q.data[i].distance=P(e,t,o)}Q.sort((function(e,t){return e.distance-t.distance}));for(var a=0;a<8;++a)n[a]=Q.data[a].index}(r,i,$);0!==a.length;){if(n(o=a.pop())&&!o.isLeaf())for(var s=7;s>=0;--s){var u=$[s];o.node.children[u]&&a.push(k.acquire().init(o).advance(u))}k.release(o)}}},{key:"_remove",value:function(e,t,n){K.clear();var r=n.advanceTo(t,(function(e,t){K.push(e.node),K.push(t)}))?n.node.terminals:n.node.residents;if(r.removeUnordered(e),0===r.length)for(var i=K.length-2;i>=0;i-=2){var o=K.data[i],a=K.data[i+1];if(!this._purge(o,a))break}}},{key:"_nodeIsEmpty",value:function(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(var t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0}},{key:"_purge",value:function(e,t){return t>=0&&(e.children[t]=null),!!this._nodeIsEmpty(e)&&(null===e.residents&&(e.residents=new g.Z({shrink:!0})),!0)}},{key:"_add",value:function(e,t){t.advanceTo(this._objectToBoundingSphere(e))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))}},{key:"_split",value:function(e){var t=e.node.residents;e.node.residents=null;for(var n=0;n<t.length;n++){var r=k.acquire().init(e);this._add(t.getItemAt(n),r),k.release(r)}}},{key:"_grow",value:function(e,t){var n=this;if(0!==t&&(C(e,t,(function(e){return n._objectToBoundingSphere(e)}),W),w(W[3])&&!this._fitsInsideTree(W)))if(this._nodeIsEmpty(this._root.node))(0,v.h)(W,this._root.bounds),this._root.halfSize=1.25*this._root.bounds[3],this._root.updateBoundsRadiusFromHalfSize();else{var r=this._rootBoundsForRootAsSubNode(W);this._placingRootViolatesMaxDepth(r)?this._rebuildTree(W,r):this._growRootAsSubNode(r),k.release(r)}}},{key:"_rebuildTree",value:function(e,t){var n=this;(0,h.c)(X,t.bounds),X[3]=t.halfSize,C([e,X],2,(function(e){return e}),Y);var r=k.acquire().init(this._root);this._root.initFrom(null,Y,Y[3]),this._root.increaseHalfSize(1.25),this._forEachNode(r,(function(e){return n.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&n.add(e.node.residents.data,e.node.residents.length),!0})),k.release(r)}},{key:"_placingRootViolatesMaxDepth",value:function(e){var t=this,n=Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E,r=0;return this._forEachNode(this._root,(function(e){return(r=Math.max(r,e.depth))+n<=t._maximumDepth})),r+n>this._maximumDepth}},{key:"_rootBoundsForRootAsSubNode",value:function(e){for(var t=e[3],n=e,r=-1/0,i=this._root.bounds,o=this._root.halfSize,a=0;a<3;a++){var s=i[a]-o-(n[a]-t),u=n[a]+t-(i[a]+o),c=Math.max(0,Math.ceil(s/(2*o))),l=Math.max(0,Math.ceil(u/(2*o)))+1,d=Math.pow(2,Math.ceil(Math.log(c+l)*Math.LOG2E));r=Math.max(r,d),J[a].min=c,J[a].max=l}for(var h=0;h<3;h++){var f=J[h].min,p=J[h].max,v=(r-(f+p))/2;f+=Math.ceil(v),p+=Math.floor(v);var m=i[h]-o-f*o*2;D[h]=m+(p+f)*o}var _=r*o;return D[3]=_*U,k.acquire().initFrom(null,D,_,0)}},{key:"_growRootAsSubNode",value:function(e){var t=this._root.node;(0,h.c)(W,this._root.bounds),W[3]=this._root.halfSize,this._root.init(e),e.advanceTo(W,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals}},{key:"_shrink",value:function(){for(;;){var e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}}},{key:"_findShrinkIndex",value:function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var e=null,t=this._root.node.children,n=0,r=0;r<t.length&&null==e;)e=t[n=r++];for(;r<t.length;)if(t[r++])return-1;return n}},{key:"_isDegenerate",value:function(e){return!w(this._objectToBoundingSphere(e)[3])}},{key:"_fitsInsideTree",value:function(e){var t=this._root.bounds,n=this._root.halfSize;return e[3]<=n&&e[0]>=t[0]-n&&e[0]<=t[0]+n&&e[1]>=t[1]-n&&e[1]<=t[1]+n&&e[2]>=t[2]-n&&e[2]<=t[2]+n}}]),e}(),k=function(){function e(){(0,a.Z)(this,e),this.bounds=(0,v.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}return(0,s.Z)(e,[{key:"init",value:function(e){return this.initFrom(e.node,e.bounds,e.halfSize,e.depth)}},{key:"initFrom",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.depth;return this.node=(0,c.pC)(t)?t:e.createEmptyNode(),(0,c.pC)(n)&&(0,v.h)(n,this.bounds),this.halfSize=r,this.depth=i,this}},{key:"increaseHalfSize",value:function(e){this.halfSize*=e,this.updateBoundsRadiusFromHalfSize()}},{key:"updateBoundsRadiusFromHalfSize",value:function(){this.bounds[3]=this.halfSize*U}},{key:"advance",value:function(t){var n=this.node.children[t];n||(n=e.createEmptyNode(),this.node.children[t]=n),this.node=n,this.halfSize/=2,this.depth++;var r=L[t];return this.bounds[0]+=r[0]*this.halfSize,this.bounds[1]+=r[1]*this.halfSize,this.bounds[2]+=r[2]*this.halfSize,this.updateBoundsRadiusFromHalfSize(),this}},{key:"advanceTo",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()){if(!n)return t&&t(this,-1),!1;this.node.residents=null}var r=this._childIndex(e);t&&t(this,r),this.advance(r)}}},{key:"isLeaf",value:function(){return null!=this.node.residents}},{key:"isTerminalFor",value:function(e){return e[3]>this.halfSize/2}},{key:"_childIndex",value:function(e){var t=this.bounds;return(t[0]<e[0]?1:0)+(t[1]<e[1]?2:0)+(t[2]<e[2]?4:0)}}],[{key:"createEmptyNode",value:function(){return{children:[null,null,null,null,null,null,null,null],terminals:new g.Z({shrink:!0}),residents:new g.Z({shrink:!0})}}},{key:"acquire",value:function(){return e._pool.acquire()}},{key:"release",value:function(t){e._pool.release(t)}},{key:"clearPool",value:function(){e._pool.prune()}}]),e}();function F(e,t){e[0]=Math.min(e[0],t[0]-t[3]),e[1]=Math.min(e[1],t[1]-t[3]),e[2]=Math.min(e[2],t[2]-t[3])}function S(e,t){e[0]=Math.max(e[0],t[0]+t[3]),e[1]=Math.max(e[1],t[1]+t[3]),e[2]=Math.max(e[2],t[2]+t[3])}function I(e,t,n){n[0]=e[0]+t,n[1]=e[1]+t,n[2]=e[2]+t}function C(e,t,n,r){if(1===t){var i=n(e[0]);(0,v.h)(i,r)}else{G[0]=1/0,G[1]=1/0,G[2]=1/0,q[0]=-1/0,q[1]=-1/0,q[2]=-1/0;for(var o=0;o<t;o++){var a=n(e[o]);w(a[3])&&(F(G,a),S(q,a))}(0,h.h)(r,G,q,.5),r[3]=Math.max(q[0]-G[0],q[1]-G[1],q[2]-G[2])/2}}function B(e,t){for(var n,r=1/0,i=0;i<8;++i){var o=P(e,t,j[i]);o<r&&(r=o,n=j[i])}return n}function P(e,t,n){return t*(e[0]*n[0]+e[1]*n[1]+e[2]*n[2])}function w(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0}k._pool=new _.Z(k),function(e){var t;(t=e.DepthOrder||(e.DepthOrder={}))[t.FRONT_TO_BACK=1]="FRONT_TO_BACK",t[t.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(A||(A={}));var L=[(0,f.f)(-1,-1,-1),(0,f.f)(1,-1,-1),(0,f.f)(-1,1,-1),(0,f.f)(1,1,-1),(0,f.f)(-1,-1,1),(0,f.f)(1,-1,1),(0,f.f)(-1,1,1),(0,f.f)(1,1,1)],j=[(0,f.f)(-1,-1,-1),(0,f.f)(-1,-1,1),(0,f.f)(-1,1,-1),(0,f.f)(-1,1,1),(0,f.f)(1,-1,-1),(0,f.f)(1,-1,1),(0,f.f)(1,1,-1),(0,f.f)(1,1,1)],U=Math.sqrt(3),z=[null];var D=(0,v.c)(),H=(0,f.c)(),G=(0,f.c)(),q=(0,f.c)(),K=new g.Z,V=(0,v.c)(),W=(0,v.c)(),X=(0,v.c)(),Y=(0,v.c)(),J=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],Q=new g.Z,$=[0,0,0,0,0,0,0,0],ee=A,te=n(83715);function ne(e,t,n){var r=(0,v.c)(),i=(0,v.g)(r);return(0,h.z)(i,i,e,.5),(0,h.z)(i,i,t,.5),r[3]=(0,h.i)(i,e),(0,h.a)(i,i,n),r}var re=function(){function e(){(0,a.Z)(this,e),this._idToComponent=new Map,this._components=new ee((function(e){return e.bounds})),this._edges=new ee((function(e){return e.bounds})),this._tmpLineSegment=(0,p.Ue)(),this._tmpP1=(0,f.c)(),this._tmpP2=(0,f.c)(),this._tmpP3=(0,f.c)(),this.remoteClient=null}return(0,s.Z)(e,[{key:"fetchCandidates",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,n){var r,o=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:return(0,l.k_)(n),e.next=5,this._ensureEdgeLocations(t,n);case 5:return r=[],e.abrupt("return",(this._edges.forEachNeighbor((function(e){return o._addCandidates(t,e,r),r.length<1e3}),t.bounds),{result:{candidates:r}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_ensureEdgeLocations",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,n){var o,a,s,u,l,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=[],this._components.forEachNeighbor((function(e){if((0,c.Wi)(e.info)){var t=e.id,n=e.uid;o.push({id:t,uid:n})}return!0}),t.bounds),o.length){e.next=3;break}return e.abrupt("return");case 3:return a={components:o},e.next=6,this.remoteClient.invoke("fetchAllEdgeLocations",a,(0,c.Pt)(n,{}));case 6:s=e.sent,u=(0,r.Z)(s.components);try{for(u.s();!(l=u.n()).done;)d=l.value,this._setFetchEdgeLocations(d)}catch(i){u.e(i)}finally{u.f()}case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new oe(t.id,t.bounds),e.abrupt("return",(this._idToComponent.set(n.id,n),this._components.add([n]),{result:{}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this._idToComponent.get(t.id))&&(r=[],this._edges.forEachNeighbor((function(e){return e.component===n&&r.push(e),!0}),n.bounds),this._edges.remove(r),this._components.remove([n]),this._idToComponent.delete(n.id)),e.abrupt("return",{result:{}});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_setFetchEdgeLocations",value:function(e){var t=this._idToComponent.get(e.id);if(!(0,c.Wi)(t)&&e.uid===t.uid){for(var n=te.n_.createView(e.locations),r=new Array(n.count),i=(0,f.c)(),o=(0,f.c)(),a=0;a<n.count;a++){n.position0.getVec(a,i),n.position1.getVec(a,o);var s=ne(i,o,e.origin),u=new ae(t,a,s);r[a]=u}this._edges.add(r);var l=e.objectIds,d=e.origin;t.info={locations:n,objectIds:l,origin:d}}}},{key:"_addCandidates",value:function(e,t,n){var r=t.component.info,i=r.origin,o=r.objectIds,a=r.locations,s=a.position0.getVec(t.index,this._tmpP1),u=a.position1.getVec(t.index,this._tmpP2);(0,h.a)(s,s,i),(0,h.a)(u,u,i);var c=o[a.componentIndex.get(t.index)];this._addEdgeCandidate(e,c,s,u,n),this._addVertexCandidate(e,c,s,n),this._addVertexCandidate(e,c,u,n)}},{key:"_addEdgeCandidate",value:function(e,t,n,r,i){if(e.types&m.r.EDGE){var o=(0,v.g)(e.bounds),a=(0,p.zk)(n,r,this._tmpLineSegment),s=(0,p.nF)(a,o,this._tmpP3);(0,v.m)(e.bounds,s)&&i.push({type:"edge",objectId:t,target:(0,f.a)(s),distance:(0,h.i)(o,s),start:(0,f.a)(n),end:(0,f.a)(r)})}}},{key:"_addVertexCandidate",value:function(e,t,n,r){if(e.types&m.r.VERTEX){var i=(0,v.g)(e.bounds);(0,v.m)(e.bounds,n)&&r.push({type:"vertex",objectId:t,target:(0,f.a)(n),distance:(0,h.i)(i,n)})}}}]),e}(),ie=re=(0,u._)([(0,d.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],re),oe=(0,s.Z)((function e(t,n){(0,a.Z)(this,e),this.id=t,this.bounds=n,this.info=null,this.uid=++e.uid}));oe.uid=0;var ae=(0,s.Z)((function e(t,n,r){(0,a.Z)(this,e),this.component=t,this.index=n,this.bounds=r}))}}]);
//# sourceMappingURL=3956.06ddd292.chunk.js.map